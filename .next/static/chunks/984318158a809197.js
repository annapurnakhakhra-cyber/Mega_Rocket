(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},78894,e=>{"use strict";let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},51687,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(55436),l=e.i(40160),r=e.i(78894);e.s(["default",0,()=>{let[e,c]=(0,s.useState)([]),[i,n]=(0,s.useState)([]),[d,o]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1),[x,h]=(0,s.useState)({start:"",end:""}),p=async()=>{m(!0);try{let e=await fetch("/api/discounts"),t=await e.json();if(t.success){let{priceRules:e=[],automaticDiscounts:s=[]}=t.discounts,a=[...e.map(e=>({id:e.id,title:e.title,value:e.value,value_type:e.value_type,starts_at:e.starts_at,ends_at:e.ends_at,type:"price_rule"})),...s.map(e=>({id:e.node.id,title:e.node.automaticDiscount?.title||"Automatic Discount",value:e.node.automaticDiscount?.customerGets?.value?.percentage||e.node.automaticDiscount?.customerGets?.value?.amount?.amount||null,value_type:e.node.automaticDiscount?.customerGets?.value?.percentage?"percentage":"amount",starts_at:e.node.automaticDiscount?.startsAt,ends_at:e.node.automaticDiscount?.endsAt,type:"automatic_discount"}))];c(a),n(a)}else c([]),n([]),console.error("Invalid discounts data:",t.discounts)}catch(e){console.error("Failed to fetch discounts:",e),c([]),n([])}finally{m(!1)}};return(0,s.useEffect)(()=>{p()},[]),(0,s.useEffect)(()=>{n(e.filter(e=>(e.title||"").toLowerCase().includes(d.toLowerCase())||String(e.value||"").includes(d)))},[d,e]),(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Discounts Manager"})}),(0,t.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6 flex items-center gap-3",children:[(0,t.jsx)(r.AlertTriangle,{className:"w-5 h-5 text-orange-600 flex-shrink-0"}),(0,t.jsx)("p",{className:"text-sm text-orange-800 flex-1",children:"Discounts data fetched from Shopify Admin API."})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Discounts"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]})})})}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"relative w-full md:w-64",children:[(0,t.jsx)(a.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,t.jsx)("input",{type:"text",placeholder:"Search discounts...",value:d,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),(0,t.jsxs)("button",{onClick:()=>{if(!i.length)return;let e=new Blob(["ID,Title,Value,Type,Starts At,Ends At\n"+i.map(e=>[e.id,e.title,e.value,e.value_type,e.starts_at,e.ends_at||""]).map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="discounts.csv",s.click()},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,t.jsx)(l.Download,{className:"w-4 h-4"})," Download All"]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-100 border-b border-gray-200",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left",children:"Title"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left",children:"Value"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left",children:"Type"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left",children:"Starts"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left",children:"Ends"})]})}),(0,t.jsx)("tbody",{children:u?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:"5",className:"p-4 text-center",children:"Loading discounts..."})}):0===i.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:"5",className:"p-16 text-center text-gray-400 font-semibold",children:"No discounts found."})}):i.map(e=>(0,t.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-3",children:e.title}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.value}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.value_type}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.starts_at}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.ends_at||"--"})]},e.id))})]})})]})})}])}]);