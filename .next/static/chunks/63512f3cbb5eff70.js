(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},47615,e=>{"use strict";let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],47615)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},61601,e=>{"use strict";var t=e.i(47167),s=e.i(43476),r=e.i(71645),a=e.i(55436),l=e.i(47615),o=e.i(75254);let d=(0,o.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),n=(0,o.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),c=(0,o.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var i=e.i(43531);let u=t.default.env.NEXT_PUBLIC_API_URL||"http://10.27.4.11:3001";function p(){let[e,t]=(0,r.useState)([]),[o,p]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[g,x]=(0,r.useState)(!0),[f,y]=(0,r.useState)(null),[j,v]=(0,r.useState)({}),[N,b]=(0,r.useState)(""),[w,S]=(0,r.useState)("all"),[A,E]=(0,r.useState)("default");(0,r.useEffect)(()=>{P()},[]),(0,r.useEffect)(()=>{k()},[N,w,A,e,o]);let P=async()=>{try{x(!0),y(null),console.log("Fetching all products...");let e=await fetch(`${u}/api/products/list`);if(console.log("Products response status:",e.status),!e.ok)throw Error(`Failed to fetch products: ${e.status}`);let s=await e.json(),r=s.products||s.data||s||[];if(console.log("Parsed products:",r.length),!Array.isArray(r))throw Error("Products is not an array");t(r),console.log("Fetching suggested products...");let a=await fetch(`${u}/api/suggested/list`);if(console.log("Suggested response status:",a.status),a.ok){let e=await a.json();console.log("Suggested data:",e);let t=e.products||[];p(t)}else console.log("Suggested products API not available yet"),p([])}catch(e){console.error("Error fetching data:",e),y(e.message)}finally{x(!1)}},k=()=>{if(!Array.isArray(e)||0===e.length)return void m([]);let t=[...e];N&&(t=t.filter(e=>e.title?.toLowerCase().includes(N.toLowerCase())||e.vendor?.toLowerCase().includes(N.toLowerCase()))),"all"!==w&&(t=t.filter(e=>e.vendor===w)),t.sort((e,t)=>{let s=C(e.id),r=C(t.id);if(s&&!r)return -1;if(!s&&r)return 1;switch(A){case"price-low":return parseFloat(e.price?.amount||0)-parseFloat(t.price?.amount||0);case"price-high":return parseFloat(t.price?.amount||0)-parseFloat(e.price?.amount||0);case"name-az":return e.title.localeCompare(t.title);case"name-za":return t.title.localeCompare(e.title);default:return 0}}),m(t)},C=e=>o.some(t=>t.shopifyProductId===e),I=async e=>{v({...j,[e.id]:!0});try{let t;console.log("Adding product to suggested:",e.id),console.log("Request payload:",{shopifyProductId:e.id,productHandle:e.handle,title:e.title,vendor:e.vendor,price:parseFloat(e.price?.amount||0)});let s=await fetch(`${u}/api/suggested/add`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({shopifyProductId:e.id,productHandle:e.handle,title:e.title,vendor:e.vendor||"",price:parseFloat(e.price?.amount||0),compareAtPrice:e.compareAtPrice?.amount?parseFloat(e.compareAtPrice.amount):null,featuredImageUrl:e.featuredImage?.url||"",variantId:e.variantId||""})});console.log("Add response status:",s.status),console.log("Add response headers:",s.headers);let r=s.headers.get("content-type");console.log("Content-Type:",r);let a=await s.text();if(console.log("Response text:",a),a)try{t=JSON.parse(a)}catch(e){throw console.error("JSON parse error:",e),Error(`Invalid JSON response: ${a.substring(0,100)}`)}else throw Error("Empty response from server");if(!s.ok)throw Error(t.error||t.message||`Server error: ${s.status}`);if(!t.success)throw Error(t.error||"Failed to add product");console.log("Product added successfully!"),await P(),alert("✅ Product added to suggested list!")}catch(e){console.error("Error adding product:",e),alert("❌ Error: "+e.message)}finally{v({...j,[e.id]:!1})}},F=async e=>{v({...j,[e.id]:!0});try{let t;console.log("Removing product from suggested:",e.id);let s=await fetch(`${u}/api/suggested/remove`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({shopifyProductId:e.id})});console.log("Remove response status:",s.status);let r=await s.text();if(console.log("Response text:",r),r)try{t=JSON.parse(r)}catch(e){throw console.error("JSON parse error:",e),Error(`Invalid JSON response: ${r.substring(0,100)}`)}else throw Error("Empty response from server");if(!s.ok)throw Error(t.error||t.message||`Server error: ${s.status}`);if(!t.success)throw Error(t.error||"Failed to remove product");console.log("Product removed successfully!"),await P(),alert("✅ Product removed from suggested list!")}catch(e){console.error("Error removing product:",e),alert("❌ Error: "+e.message)}finally{v({...j,[e.id]:!1})}},O=["all",...new Set(e.map(e=>e.vendor).filter(Boolean))];return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 to-orange-50",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-[#7C4A0E] mb-2",children:"Manage Suggested Products"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Add or remove products from the suggested list. Suggested products appear first."}),(0,s.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,s.jsx)("div",{className:"bg-blue-100 px-4 py-2 rounded-lg",children:(0,s.jsxs)("span",{className:"text-blue-800 font-semibold",children:[e.length," Total Products"]})}),(0,s.jsx)("div",{className:"bg-green-100 px-4 py-2 rounded-lg",children:(0,s.jsxs)("span",{className:"text-green-800 font-semibold",children:[o.length," Suggested Products"]})})]})]}),f&&(0,s.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-8",children:[(0,s.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,s.jsx)("span",{className:"block sm:inline",children:f}),(0,s.jsx)("button",{onClick:P,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:"Retry"})]}),(0,s.jsxs)("div",{className:"bg-white/90 backdrop-blur-md border border-white/30 rounded-2xl p-6 mb-8 shadow-lg",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(a.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,s.jsx)("input",{type:"text",placeholder:"Search products...",value:N,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.Filter,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,s.jsx)("select",{value:w,onChange:e=>S(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 appearance-none bg-white",children:O.map(e=>(0,s.jsx)("option",{value:e,children:"all"===e?"All Vendors":e},e))})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:A,onChange:e=>E(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 appearance-none bg-white",children:[(0,s.jsx)("option",{value:"default",children:"Default Order"}),(0,s.jsx)("option",{value:"price-low",children:"Price: Low to High"}),(0,s.jsx)("option",{value:"price-high",children:"Price: High to Low"}),(0,s.jsx)("option",{value:"name-az",children:"Name: A to Z"}),(0,s.jsx)("option",{value:"name-za",children:"Name: Z to A"})]})})]}),(0,s.jsxs)("div",{className:"mt-4 text-center text-gray-600",children:["Showing ",h.length," of ",e.length," products"]})]}),g&&(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center py-20",children:[(0,s.jsx)(d,{className:"w-12 h-12 text-orange-600 animate-spin mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading products..."})]}),!g&&!f&&(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-[#7C4A0E] text-white",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Image"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Product"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Vendor"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Price"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold",children:"Action"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:h.map(e=>{let t=Number(e?.price?.amount||0),r=Number(e?.compareAtPrice?.amount||0),a=C(e.id),l=j[e.id];return(0,s.jsxs)("tr",{className:`hover:bg-gray-50 transition ${a?"bg-green-50":""}`,children:[(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"relative w-20 h-20 rounded-lg overflow-hidden",children:e.featuredImage?.url?(0,s.jsx)("img",{src:e.featuredImage.url,alt:e.title,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"No Image"})})})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-semibold text-gray-900 line-clamp-2 max-w-xs",children:e.title}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 mt-1",children:["ID: ",e.id.split("/").pop()]})]})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("span",{className:"text-sm text-gray-600",children:e.vendor||"Unknown"})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("span",{className:"text-lg font-bold text-orange-600",children:["₹",t]}),r>t&&(0,s.jsxs)("span",{className:"text-sm line-through text-gray-400",children:["₹",r]})]})}),(0,s.jsx)("td",{className:"px-6 py-4",children:a?(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[(0,s.jsx)(i.Check,{className:"w-4 h-4"}),"Suggested"]}):(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm",children:"Not Added"})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"flex justify-center",children:a?(0,s.jsxs)("button",{onClick:()=>F(e),disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[l?(0,s.jsx)(d,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(c,{className:"w-4 h-4"}),"Remove"]}):(0,s.jsxs)("button",{onClick:()=>I(e),disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[l?(0,s.jsx)(d,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(n,{className:"w-4 h-4"}),"Add"]})})})]},e.id)})})]})}),0===h.length&&!g&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("p",{className:"text-gray-500 text-lg",children:"No products found"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Try adjusting your search or filters"})]})]})]})})}e.s(["default",()=>p],61601)}]);