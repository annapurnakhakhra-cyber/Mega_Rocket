module.exports=[87532,a=>{"use strict";let b=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],87532)},69012,a=>{"use strict";let b=(0,a.i(70106).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);a.s(["Filter",()=>b],69012)},33441,a=>{"use strict";let b=(0,a.i(70106).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>b],33441)},48738,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(87532),e=a.i(69012),f=a.i(70106);let g=(0,f.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),h=(0,f.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),i=(0,f.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var j=a.i(33441);let k=process.env.NEXT_PUBLIC_API_URL||"http://10.27.4.11:3001";function l(){let[a,f]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)({}),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)("all"),[z,A]=(0,c.useState)("default");(0,c.useEffect)(()=>{B()},[]),(0,c.useEffect)(()=>{C()},[v,x,z,a,l]);let B=async()=>{try{q(!0),s(null),console.log("Fetching all products...");let a=await fetch(`${k}/api/products/list`);if(console.log("Products response status:",a.status),!a.ok)throw Error(`Failed to fetch products: ${a.status}`);let b=await a.json(),c=b.products||b.data||b||[];if(console.log("Parsed products:",c.length),!Array.isArray(c))throw Error("Products is not an array");f(c),console.log("Fetching suggested products...");let d=await fetch(`${k}/api/suggested/list`);if(console.log("Suggested response status:",d.status),d.ok){let a=await d.json();console.log("Suggested data:",a);let b=a.products||[];m(b)}else console.log("Suggested products API not available yet"),m([])}catch(a){console.error("Error fetching data:",a),s(a.message)}finally{q(!1)}},C=()=>{if(!Array.isArray(a)||0===a.length)return void o([]);let b=[...a];v&&(b=b.filter(a=>a.title?.toLowerCase().includes(v.toLowerCase())||a.vendor?.toLowerCase().includes(v.toLowerCase()))),"all"!==x&&(b=b.filter(a=>a.vendor===x)),b.sort((a,b)=>{let c=D(a.id),d=D(b.id);if(c&&!d)return -1;if(!c&&d)return 1;switch(z){case"price-low":return parseFloat(a.price?.amount||0)-parseFloat(b.price?.amount||0);case"price-high":return parseFloat(b.price?.amount||0)-parseFloat(a.price?.amount||0);case"name-az":return a.title.localeCompare(b.title);case"name-za":return b.title.localeCompare(a.title);default:return 0}}),o(b)},D=a=>l.some(b=>b.shopifyProductId===a),E=async a=>{u({...t,[a.id]:!0});try{let b;console.log("Adding product to suggested:",a.id),console.log("Request payload:",{shopifyProductId:a.id,productHandle:a.handle,title:a.title,vendor:a.vendor,price:parseFloat(a.price?.amount||0)});let c=await fetch(`${k}/api/suggested/add`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({shopifyProductId:a.id,productHandle:a.handle,title:a.title,vendor:a.vendor||"",price:parseFloat(a.price?.amount||0),compareAtPrice:a.compareAtPrice?.amount?parseFloat(a.compareAtPrice.amount):null,featuredImageUrl:a.featuredImage?.url||"",variantId:a.variantId||""})});console.log("Add response status:",c.status),console.log("Add response headers:",c.headers);let d=c.headers.get("content-type");console.log("Content-Type:",d);let e=await c.text();if(console.log("Response text:",e),e)try{b=JSON.parse(e)}catch(a){throw console.error("JSON parse error:",a),Error(`Invalid JSON response: ${e.substring(0,100)}`)}else throw Error("Empty response from server");if(!c.ok)throw Error(b.error||b.message||`Server error: ${c.status}`);if(!b.success)throw Error(b.error||"Failed to add product");console.log("Product added successfully!"),await B(),alert("✅ Product added to suggested list!")}catch(a){console.error("Error adding product:",a),alert("❌ Error: "+a.message)}finally{u({...t,[a.id]:!1})}},F=async a=>{u({...t,[a.id]:!0});try{let b;console.log("Removing product from suggested:",a.id);let c=await fetch(`${k}/api/suggested/remove`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({shopifyProductId:a.id})});console.log("Remove response status:",c.status);let d=await c.text();if(console.log("Response text:",d),d)try{b=JSON.parse(d)}catch(a){throw console.error("JSON parse error:",a),Error(`Invalid JSON response: ${d.substring(0,100)}`)}else throw Error("Empty response from server");if(!c.ok)throw Error(b.error||b.message||`Server error: ${c.status}`);if(!b.success)throw Error(b.error||"Failed to remove product");console.log("Product removed successfully!"),await B(),alert("✅ Product removed from suggested list!")}catch(a){console.error("Error removing product:",a),alert("❌ Error: "+a.message)}finally{u({...t,[a.id]:!1})}},G=["all",...new Set(a.map(a=>a.vendor).filter(Boolean))];return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 to-orange-50",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-[#7C4A0E] mb-2",children:"Manage Suggested Products"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Add or remove products from the suggested list. Suggested products appear first."}),(0,b.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,b.jsx)("div",{className:"bg-blue-100 px-4 py-2 rounded-lg",children:(0,b.jsxs)("span",{className:"text-blue-800 font-semibold",children:[a.length," Total Products"]})}),(0,b.jsx)("div",{className:"bg-green-100 px-4 py-2 rounded-lg",children:(0,b.jsxs)("span",{className:"text-green-800 font-semibold",children:[l.length," Suggested Products"]})})]})]}),r&&(0,b.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-8",children:[(0,b.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,b.jsx)("span",{className:"block sm:inline",children:r}),(0,b.jsx)("button",{onClick:B,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:"Retry"})]}),(0,b.jsxs)("div",{className:"bg-white/90 backdrop-blur-md border border-white/30 rounded-2xl p-6 mb-8 shadow-lg",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(d.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,b.jsx)("input",{type:"text",placeholder:"Search products...",value:v,onChange:a=>w(a.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(e.Filter,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,b.jsx)("select",{value:x,onChange:a=>y(a.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 appearance-none bg-white",children:G.map(a=>(0,b.jsx)("option",{value:a,children:"all"===a?"All Vendors":a},a))})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("select",{value:z,onChange:a=>A(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 appearance-none bg-white",children:[(0,b.jsx)("option",{value:"default",children:"Default Order"}),(0,b.jsx)("option",{value:"price-low",children:"Price: Low to High"}),(0,b.jsx)("option",{value:"price-high",children:"Price: High to Low"}),(0,b.jsx)("option",{value:"name-az",children:"Name: A to Z"}),(0,b.jsx)("option",{value:"name-za",children:"Name: Z to A"})]})})]}),(0,b.jsxs)("div",{className:"mt-4 text-center text-gray-600",children:["Showing ",n.length," of ",a.length," products"]})]}),p&&(0,b.jsxs)("div",{className:"flex flex-col justify-center items-center py-20",children:[(0,b.jsx)(g,{className:"w-12 h-12 text-orange-600 animate-spin mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading products..."})]}),!p&&!r&&(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-[#7C4A0E] text-white",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Image"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Product"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Vendor"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Price"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold",children:"Action"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200",children:n.map(a=>{let c=Number(a?.price?.amount||0),d=Number(a?.compareAtPrice?.amount||0),e=D(a.id),f=t[a.id];return(0,b.jsxs)("tr",{className:`hover:bg-gray-50 transition ${e?"bg-green-50":""}`,children:[(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("div",{className:"relative w-20 h-20 rounded-lg overflow-hidden",children:a.featuredImage?.url?(0,b.jsx)("img",{src:a.featuredImage.url,alt:a.title,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"No Image"})})})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-900 line-clamp-2 max-w-xs",children:a.title}),(0,b.jsxs)("span",{className:"text-xs text-gray-500 mt-1",children:["ID: ",a.id.split("/").pop()]})]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.vendor||"Unknown"})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsxs)("span",{className:"text-lg font-bold text-orange-600",children:["₹",c]}),d>c&&(0,b.jsxs)("span",{className:"text-sm line-through text-gray-400",children:["₹",d]})]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:e?(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[(0,b.jsx)(j.Check,{className:"w-4 h-4"}),"Suggested"]}):(0,b.jsx)("span",{className:"inline-flex items-center px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm",children:"Not Added"})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("div",{className:"flex justify-center",children:e?(0,b.jsxs)("button",{onClick:()=>F(a),disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[f?(0,b.jsx)(g,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(i,{className:"w-4 h-4"}),"Remove"]}):(0,b.jsxs)("button",{onClick:()=>E(a),disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[f?(0,b.jsx)(g,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(h,{className:"w-4 h-4"}),"Add"]})})})]},a.id)})})]})}),0===n.length&&!p&&(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("p",{className:"text-gray-500 text-lg",children:"No products found"}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Try adjusting your search or filters"})]})]})]})})}a.s(["default",()=>l],48738)}];

//# sourceMappingURL=_c9db7aae._.js.map