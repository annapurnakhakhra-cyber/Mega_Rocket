module.exports=[87532,a=>{"use strict";let b=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],87532)},73570,a=>{"use strict";let b=(0,a.i(70106).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);a.s(["AlertTriangle",()=>b],73570)},33706,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(87532),e=a.i(84505),f=a.i(73570);a.s(["default",0,()=>{let[a,g]=(0,c.useState)([]),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)({start:"",end:""}),p=async()=>{m(!0);try{let a=await fetch("/api/discounts"),b=await a.json();if(b.success){let{priceRules:a=[],automaticDiscounts:c=[]}=b.discounts,d=[...a.map(a=>({id:a.id,title:a.title,value:a.value,value_type:a.value_type,starts_at:a.starts_at,ends_at:a.ends_at,type:"price_rule"})),...c.map(a=>({id:a.node.id,title:a.node.automaticDiscount?.title||"Automatic Discount",value:a.node.automaticDiscount?.customerGets?.value?.percentage||a.node.automaticDiscount?.customerGets?.value?.amount?.amount||null,value_type:a.node.automaticDiscount?.customerGets?.value?.percentage?"percentage":"amount",starts_at:a.node.automaticDiscount?.startsAt,ends_at:a.node.automaticDiscount?.endsAt,type:"automatic_discount"}))];g(d),i(d)}else g([]),i([]),console.error("Invalid discounts data:",b.discounts)}catch(a){console.error("Failed to fetch discounts:",a),g([]),i([])}finally{m(!1)}};return(0,c.useEffect)(()=>{p()},[]),(0,c.useEffect)(()=>{i(a.filter(a=>(a.title||"").toLowerCase().includes(j.toLowerCase())||String(a.value||"").includes(j)))},[j,a]),(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-6",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Discounts Manager"})}),(0,b.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6 flex items-center gap-3",children:[(0,b.jsx)(f.AlertTriangle,{className:"w-5 h-5 text-orange-600 flex-shrink-0"}),(0,b.jsx)("p",{className:"text-sm text-orange-800 flex-1",children:"Discounts data fetched from Shopify Admin API."})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:(0,b.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Total Discounts"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:a.length})]})})})}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[(0,b.jsxs)("div",{className:"relative w-full md:w-64",children:[(0,b.jsx)(d.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,b.jsx)("input",{type:"text",placeholder:"Search discounts...",value:j,onChange:a=>k(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),(0,b.jsxs)("button",{onClick:()=>{if(!h.length)return;let a=new Blob(["ID,Title,Value,Type,Starts At,Ends At\n"+h.map(a=>[a.id,a.title,a.value,a.value_type,a.starts_at,a.ends_at||""]).map(a=>a.join(",")).join("\n")],{type:"text/csv"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download="discounts.csv",c.click()},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,b.jsx)(e.Download,{className:"w-4 h-4"})," Download All"]})]}),(0,b.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-100 border-b border-gray-200",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Title"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Value"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Type"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Starts"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Ends"})]})}),(0,b.jsx)("tbody",{children:l?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:"5",className:"p-4 text-center",children:"Loading discounts..."})}):0===h.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:"5",className:"p-16 text-center text-gray-400 font-semibold",children:"No discounts found."})}):h.map(a=>(0,b.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:a.title}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.value}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.value_type}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.starts_at}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.ends_at||"--"})]},a.id))})]})})]})})}])}];

//# sourceMappingURL=_74c8272e._.js.map